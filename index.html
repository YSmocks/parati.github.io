<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Un mensaje para ti</title>
    <!-- Tipografía para títulos y firma -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Great+Vibes&display=swap" rel="stylesheet">
    <!-- Tipografía para el cuerpo del texto, más legible -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    
    <!-- Incluimos Tailwind CSS desde CDN para un diseño fácil y responsive -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Incluimos Three.js para crear el fondo animado -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <style>
        /* La tipografía principal del cuerpo es ahora 'Inter' para mayor legibilidad */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #0d011f; /* Un fondo oscuro para el efecto del espacio */
            color: #e2e8f0;
            overflow-x: hidden;
        }
        h1, h2 {
            font-family: 'Great Vibes', cursive;
            font-weight: 700;
            /* Efecto de sombra para simular el neón */
            text-shadow: 0 0 5px #ff00ff, 0 0 10px #ff00ff;
        }
        /* Estilos del canvas para el fondo animado de Three.js */
        #bg-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: -1;
            opacity: 1;
        }
        .section-container {
            opacity: 0;
            transform: translateY(20px);
            transition: opacity 1s ease-out, transform 1s ease-out;
        }
        .section-container.is-visible {
            opacity: 1;
            transform: translateY(0);
        }
        /* Clases CSS para los estilos del reproductor */
        .glass-effect {
            background: linear-gradient(
                to bottom,
                rgba(255, 255, 255, 0.05) 0%,
                rgba(255, 255, 255, 0.02) 100%
            );
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
        }
        .progress-width {
            width: 0%;
        }
        
        /* Estilos para el sobre realista */
        .envelope-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin: 0 auto;
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            perspective: 1000px; /* Perspectiva 3D para la animación */
            z-index: 10;
        }
        .envelope {
            position: relative;
            width: 90%;
            /* Altura fija para que el sobre sea visible, el problema anterior era que el contenedor colapsaba */
            height: 280px; 
            max-width: 540px;
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.3);
            z-index: 1;
            transition: transform 1s cubic-bezier(0.68, -0.55, 0.27, 1.55);
        }
        
        /* Contenedor de las aletas del sobre */
        .envelope-flaps {
            position: absolute;
            inset: 0;
            overflow: hidden;
          /*  border-radius: 24px; */
            z-index: 1;
        }
        .envelope-flaps .bottom-flap, .envelope-flaps .left-flap, .envelope-flaps .right-flap {
            position: absolute;
            background-color: #7b6ac4;
            transition: transform 0.5s ease;
        }
        .envelope-flaps .bottom-flap {
            width: 100%;
            height: 50%;
            bottom: 0;
            clip-path: polygon(0 100%, 50% 0, 100% 100%);
        }
        .envelope-flaps .left-flap {
            width: 50%;
            height: 100%;
            left: 0;
            clip-path: polygon(0 0, 100% 50%, 0 100%);
        }
        .envelope-flaps .right-flap {
            width: 50%;
            height: 100%;
            right: 0;
            clip-path: polygon(0 50%, 100% 0, 100% 100%);
        }

        /* La carta en sí */
        .letter {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 280px;
            max-height: 50vh; /* Se asegura que no sea demasiado alta en móviles */
            background-color: #fefefe;
            color: #333;
            border-radius: 20px;
            padding: 2rem; /* Aumento del padding para mejor legibilidad */
            box-sizing: border-box;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            opacity: 0;
            transform: translateY(0) scale(0.9);
            transition: opacity 0.5s ease, transform 0.8s ease;
            z-index: 2;
            overflow-y: auto; /* Permite scroll si el contenido es largo */
        }

        /* La solapa superior que se mueve */
        .top-flap {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 50%;
            background-color: #8c7ae6;
            transform-origin: top;
            transition: transform 0.8s ease-in-out;
            z-index: 3;
            clip-path: polygon(0 0, 100% 0, 50% 100%);
        }
        
        /* Estados cuando el sobre está abierto */
        .envelope.open .top-flap {
            transform: rotateX(180deg);
            z-index: 1;
        }
        .envelope.open .letter {
            opacity: 1;
            transform: translateY(0) scale(1);
        }

        /* Para aplicar la fuente 'Great Vibes' solo en la firma */
        .signature-font {
            font-family: 'Great Vibes', cursive;
            font-size: medium;
        }
    </style>
</head>
<body class="text-gray-200">

    <!-- Canvas para el fondo animado de Three.js -->
    <canvas id="bg-canvas"></canvas>

    <!-- Sección principal (Hero) -->
    <header class="relative z-10 text-white py-20 px-4 md:px-8 text-center" style="background: linear-gradient(135deg, rgba(79, 70, 229, 0.4), rgba(168, 85, 247, 0.4));">
        <div class="container mx-auto section-container">
            <h1 class="text-4xl sm:text-5xl md:text-6xl font-bold mb-4">Para Ti</h1>
            <p class="text-lg sm:text-xl md:text-2xl font-light">
                Con todo el cariño del mundo.
            </p>
        </div>
    </header>

    <main class="container mx-auto px-4 py-16 relative z-10">
        
        <!-- Sección de Música (reproductor avanzado) -->
        <section id="musica" class="text-center section-container mb-16">
            <h2 class="text-3xl font-bold text-center mb-8 text-pink-300">Una canción para el camino</h2>
            <div class="max-w-md mx-auto">
                <div class="w-full max-w-sm p-4 mx-auto">
                  <div class="relative overflow-hidden rounded-lg transition-all duration-300 group audio-container bg-background/20 hover:scale-[1.02] text-foreground backdrop-blur-[2px] p-6 bg-black hover:shadow-lg hover:shadow-primary/20">
                    <div class="relative z-10">
                      <div class="flex items-start gap-2">
                        <div class="relative h-16 w-16 shrink-0 overflow-hidden rounded-2xl flex items-center justify-center bg-zinc-200 dark:bg-zinc-800 -mt-1.5">
                          <!-- Icono de la canción -->
                          <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="text-zinc-500">
                            <path d="M9 18V5l12-2v13"></path>
                            <circle cx="6" cy="18" r="3"></circle>
                            <circle cx="18" cy="16" r="3"></circle>
                          </svg>
                          <div class="absolute inset-0 ring-1 ring-inset ring-black/10 dark:ring-white/10 rounded-2xl"></div>
                        </div>
                        <div class="flex-1">
                          <div class="flex items-start justify-between gap-4">
                            <div class="space-y-1.5">
                              <p class="font-semibold leading-none tracking-tight text-foreground dark:text-white">
                                Maroon 5
                              </p>
                              <p class="text-sm text-muted-foreground/80 dark:text-zinc-400">
                                Memories
                              </p>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="pt-6 text-foreground dark:text-white">
                        <div class="space-y-2">
                          <div class="relative h-1.5 w-full overflow-hidden rounded-full bg-zinc-200/50 dark:bg-zinc-800/50" role="presentation" id="progress-bar-container">
                            <div class="absolute inset-0 bg-gradient-to-r from-zinc-300/20 via-zinc-300/30 to-zinc-300/20 dark:from-white/5 dark:via-white/10 dark:to-white/5"></div>
                            <div class="absolute inset-y-0 left-0 flex bg-gradient-to-r from-black/50 via-black/50 to-black/50 dark:from-white/80 dark:via-white/80 dark:to-white/80 transition-all duration-200 ease-out progress-width" id="progress-bar">
                              <div class="absolute inset-0 bg-gradient-to-t from-black/5 to-white/5"></div>
                            </div>
                          </div>
                          <div class="flex justify-between text-xs font-medium">
                            <span class="tabular-nums text-zinc-600 dark:text-zinc-400" id="current-time">0:00</span>
                            <span class="tabular-nums text-zinc-600 dark:text-zinc-400" id="duration">0:00</span>
                          </div>
                        </div>
                        <div class="mt-6 flex items-center justify-center gap-6">
                          <!-- Botón de Anterior -->
                          <button class="relative inline-flex items-center transition-colors justify-center cursor-pointer gap-2 whitespace-nowrap rounded-full text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 bg-transparent hover:scale-105 duration-300 transition text-primary h-9 w-9 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-100" aria-label="Previous track" id="prev-button">
                            <div class="absolute top-0 left-0 z-0 h-full w-full rounded-full shadow-[0_0_6px_rgba(0,0,0,0.03),0_2px_6px_rgba(0,0,0,0.08),inset_3px_3px_0.5px_-3px_rgba(0,0,0,0.9),inset_-3px_-3px_0.5px_-3px_rgba(0,0,0,0.85),inset_1px_1px_1px_-0.5px_rgba(0,0,0,0.6),inset_-1px_-1px_1px_-0.5px_rgba(0,0,0,0.6),inset_0_0_6px_6px_rgba(0,0,0,0.12),inset_0_0_2px_2px_rgba(0,0,0,0.06),0_0_12px_rgba(255,255,255,0.15)] transition-all dark:shadow-[0_0_8px_rgba(0,0,0,0.03),0_2px_6px_rgba(0,0,0,0.08),inset_3px_3px_0.5px_-3.5px_rgba(255,255,255,0.09),inset_-3px_-3px_0.5px_-3.5px_rgba(255,255,255,0.85),inset_1px_1px_1px_-0.5px_rgba(255,255,255,0.6),inset_-1px_-1px_1px_-0.5px_rgba(255,255,255,0.6),inset_0_0_6px_6px_rgba(255,255,255,0.12),inset_0_0_2px_2px_rgba(255,255,255,0.06),0_0_12px_rgba(0,0,0,0.15)]"></div>
                            <div class="absolute top-0 left-0 isolate -z-10 h-full w-full overflow-hidden rounded-md glass-effect"></div>
                            <div class="pointer-events-none z-10">
                              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5">
                                <path d="m15 18-6-6 6-6"></path>
                              </svg>
                            </div>
                          </button>
                          <!-- Botón de Reproducir/Pausar -->
                          <button class="relative inline-flex items-center transition-colors justify-center cursor-pointer gap-2 whitespace-nowrap rounded-full text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 bg-transparent hover:scale-105 duration-300 transition text-primary h-9 w-9 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-100" aria-label="Pause" id="play-pause-button">
                            <div class="absolute top-0 left-0 z-0 h-full w-full rounded-full shadow-[0_0_6px_rgba(0,0,0,0.03),0_2px_6px_rgba(0,0,0,0.08),inset_3px_3px_0.5px_-3px_rgba(0,0,0,0.9),inset_-3px_-3px_0.5px_-3px_rgba(0,0,0,0.85),inset_1px_1px_1px_-0.5px_rgba(0,0,0,0.6),inset_-1px_-1px_1px_-0.5px_rgba(0,0,0,0.6),inset_0_0_6px_6px_rgba(0,0,0,0.12),inset_0_0_2px_2px_rgba(0,0,0,0.06),0_0_12px_rgba(255,255,255,0.15)] transition-all dark:shadow-[0_0_8px_rgba(0,0,0,0.03),0_2px_6px_rgba(0,0,0,0.08),inset_3px_3px_0.5px_-3.5px_rgba(255,255,255,0.09),inset_-3px_-3px_0.5px_-3.5px_rgba(255,255,255,0.85),inset_1px_1px_1px_-0.5px_rgba(255,255,255,0.6),inset_-1px_-1px_1px_-0.5px_rgba(255,255,255,0.6),inset_0_0_6px_6px_rgba(255,255,255,0.12),inset_0_0_2px_2px_rgba(255,255,255,0.06),0_0_12px_rgba(0,0,0,0.15)]"></div>
                            <div class="absolute top-0 left-0 isolate -z-10 h-full w-full overflow-hidden rounded-md glass-effect"></div>
                            <div class="pointer-events-none z-10">
                              <!-- SVG de Play (por defecto) -->
                              <svg id="play-icon" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5">
                                <polygon points="5 3 19 12 5 21 5 3"></polygon>
                              </svg>
                              <!-- SVG de Pause (oculto por defecto) -->
                              <svg id="pause-icon" class="hidden" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5">
                                <rect width="4" height="16" x="6" y="4"></rect>
                                <rect width="4" height="16" x="14" y="4"></rect>
                              </svg>
                            </div>
                          </button>
                          <!-- Botón de Siguiente -->
                          <button class="relative inline-flex items-center transition-colors justify-center cursor-pointer gap-2 whitespace-nowrap rounded-full text-sm font-medium transition-[color,box-shadow] disabled:pointer-events-none disabled:opacity-50 bg-transparent hover:scale-105 duration-300 transition text-primary h-9 w-9 text-zinc-600 hover:text-zinc-900 dark:text-zinc-400 dark:hover:text-zinc-100" aria-label="Next track" id="next-button">
                            <div class="absolute top-0 left-0 z-0 h-full w-full rounded-full shadow-[0_0_6px_rgba(0,0,0,0.03),0_2px_6px_rgba(0,0,0,0.08),inset_3px_3px_0.5px_-3px_rgba(0,0,0,0.9),inset_-3px_-3px_0.5px_-3px_rgba(0,0,0,0.85),inset_1px_1px_1px_-0.5px_rgba(0,0,0,0.6),inset_-1px_-1px_1px_-0.5px_rgba(0,0,0,0.6),inset_0_0_6px_6px_rgba(0,0,0,0.12),inset_0_0_2px_2px_rgba(0,0,0,0.06),0_0_12px_rgba(255,255,255,0.15)] transition-all dark:shadow-[0_0_8px_rgba(0,0,0,0.03),0_2px_6px_rgba(0,0,0,0.08),inset_3px_3px_0.5px_-3.5px_rgba(255,255,255,0.09),inset_-3px_-3px_0.5px_-3.5px_rgba(255,255,255,0.85),inset_1px_1px_1px_-0.5px_rgba(255,255,255,0.6),inset_-1px_-1px_1px_-0.5px_rgba(255,255,255,0.6),inset_0_0_6px_6px_rgba(255,255,255,0.12),inset_0_0_2px_2px_rgba(255,255,255,0.06),0_0_12px_rgba(0,0,0,0.15)]"></div>
                            <div class="absolute top-0 left-0 isolate -z-10 h-full w-full overflow-hidden rounded-md glass-effect"></div>
                            <div class="pointer-events-none z-10">
                              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="size-5">
                                <path d="m9 18 6-6-6-6"></path>
                              </svg>
                            </div>
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
            </div>
        </section>
        
        <!-- Sección del Mensaje Personal (Carta interactiva) -->
        <section id="mensaje-personal" class="mb-16 section-container">
            <h2 class="text-3xl font-bold text-center mb-8 text-pink-300">Un mensaje que viene del corazón</h2>
            <div class="envelope-container" id="envelope-container">
                <div class="envelope" id="envelope">
                    <!-- Contenedor para las aletas fijas del sobre -->
                    <div class="envelope-flaps">
                        <div class="bottom-flap"></div>
                        <div class="left-flap"></div>
                        <div class="right-flap"></div>
                    </div>

                    <!-- El mensaje de la carta -->
                    <div class="letter">
                        <div class="card-letter-content">
                            <p class="text-lg mb-4 text-gray-800">
                                Hola,
                            </p>
                            <p class="text-gray-700 leading-relaxed mb-6">
                                Sé que ha pasado mucho tiempo desde la última vez que hablamos y que las cosas no terminaron de la mejor manera. Es difícil para mí escribir esto, pero no quería irme sin antes decirte lo que realmente siento.
                            </p>
                            <p class="text-gray-700 leading-relaxed mb-6">
                                Quiero que sepas que, a pesar de todo lo que pasó, de los problemas que pudimos tener y de la distancia que nos separó, te quiero mucho. Los años que compartimos como mejores amigos fueron de los mejores de mi vida y guardo cada recuerdo con un inmenso cariño.
                            </p>
                            <p class="text-gray-700 leading-relaxed mb-6">
                                Lamento mucho el daño que pude haberte hecho. Mi intención nunca fue lastimarte, y entiendo que mis palabras o acciones te hirieron. De todo corazón, espero que algún día puedas perdonarme. Me duele pensar que nuestra amistad, que fue tan especial, terminó de esta manera.
                            </p>
                            <p class="text-gray-700 leading-relaxed mb-6">
                                Me llevo en el corazón cada chiste interno, cada momento de risa, cada lágrima compartida y cada vez que nos apoyamos. Eres una persona increíble y te mereces toda la felicidad del mundo.
                            </p>
                            <p class="text-gray-700 leading-relaxed">
                                Espero, de verdad, que nuestros caminos se vuelvan a cruzar algún día y que podamos volver a hablar. Hasta entonces, cuídate mucho y sé muy feliz.
                            </p>
                            <p class="text-lg mt-8 text-right font-semibold text-pink-500 signature-font">
                                Con todo mi amor, <br>
                                Yorvis
                            </p>
                        </div>
                    </div>
                    <!-- Solapa superior que se mueve para abrir el sobre -->
                    <div class="top-flap" id="top-flap"></div>
                </div>
            </div>
        </section>

        <!-- Sección de Galería de Fotos -->
        <section id="galeria" class="mb-16 section-container">
            <h2 class="text-3xl font-bold text-center mb-8 text-pink-300">Nuestros recuerdos en imágenes</h2>
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
                <!-- Imágenes de ejemplo -->
                <div class="overflow-hidden rounded-[24px] shadow-xl transform transition-all duration-500 hover:scale-105 hover:shadow-2xl">
                    <img src="1.jpg" alt="Recuerdo 1" class="w-full h-auto object-cover transform transition-transform duration-500 hover:scale-110">
                </div>
                <div class="overflow-hidden rounded-[24px] shadow-xl transform transition-all duration-500 hover:scale-105 hover:hover:shadow-2xl">
                    <img src="6.jpg" alt="Recuerdo 2" class="w-full h-auto object-cover transform transition-transform duration-500 hover:scale-110">
                </div>
                <div class="overflow-hidden rounded-[24px] shadow-xl transform transition-all duration-500 hover:scale-105 hover:shadow-2xl">
                    <img src="3.jpg" alt="Recuerdo 3" class="w-full h-auto object-cover transform transition-transform duration-500 hover:scale-110">
                </div>
                <div class="overflow-hidden rounded-[24px] shadow-xl transform transition-all duration-500 hover:scale-105 hover:shadow-2xl">
                    <img src="4.jpg" alt="Recuerdo 4" class="w-full h-auto object-cover transform transition-transform duration-500 hover:scale-110">
                </div>
                <div class="overflow-hidden rounded-[24px] shadow-xl transform transition-all duration-500 hover:scale-105 hover:shadow-2xl">
                    <img src="5.jpg" alt="Recuerdo 5" class="w-full h-auto object-cover transform transition-transform duration-500 hover:scale-110">
                </div>
                <div class="overflow-hidden rounded-[24px] shadow-xl transform transition-all duration-500 hover:scale-105 hover:shadow-2xl">
                    <img src="2.jpg" alt="Recuerdo 6" class="w-full h-auto object-cover transform transition-transform duration-500 hover:scale-110">
                </div>
            </div>
        </section>

    </main>

    <!-- Pie de página -->
    <footer class="bg-gray-900 text-white text-center py-8 mt-16 rounded-t-[40px] shadow-2xl relative z-10">
        <p class="text-sm opacity-80">Hecho con cariño para ti.</p>
    </footer>

    <!-- Audio del reproductor oculto -->
    <!-- Para cambiar la canción, reemplaza la URL en el atributo 'src' del elemento <source> -->
    <audio id="audio-player">
        <source src="Maroon 5 - Memories (Lyrics) (192 KBps).mp3" type="audio/mpeg">
        
    </audio>

    <script>
        // Lógica para el fondo animado de Three.js (partículas)
        function initializeThreeJs() {
            const scene = new THREE.Scene();
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            const renderer = new THREE.WebGLRenderer({ canvas: document.getElementById('bg-canvas'), alpha: true });
            renderer.setSize(window.innerWidth, window.innerHeight);

            // Creamos la geometría de las partículas
            const particlesGeometry = new THREE.BufferGeometry();
            const particlesCount = 5000;
            const positions = new Float32Array(particlesCount * 3);
            const colors = new Float32Array(particlesCount * 3);

            // Generamos posiciones y colores iniciales aleatorios para cada partícula
            for (let i = 0; i < particlesCount * 3; i += 3) {
                positions[i] = (Math.random() - 0.5) * 100;
                positions[i + 1] = (Math.random() - 0.5) * 100;
                positions[i + 2] = (Math.random() - 0.5) * 100;
                
                // Asignamos un color aleatorio inicial a cada partícula
                const color = new THREE.Color();
                color.setHSL(Math.random(), 1.0, 0.5); // Hue aleatorio, saturación completa, luminosidad media
                colors[i] = color.r;
                colors[i + 1] = color.g;
                colors[i + 2] = color.b;
            }

            particlesGeometry.setAttribute('position', new THREE.BufferAttribute(positions, 3));
            particlesGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));

            // Creamos el material para los puntos, ahora con un tamaño más pequeño
            const particlesMaterial = new THREE.PointsMaterial({
                size: 0.2, // Tamaño aún más pequeño para las partículas
                vertexColors: true,
                transparent: true,
                opacity: 0.8,
                blending: THREE.AdditiveBlending
            });

            const particles = new THREE.Points(particlesGeometry, particlesMaterial);
            scene.add(particles);

            camera.position.z = 50;

            // Bucle de animación para mover y cambiar el color de las partículas
            function animate() {
                requestAnimationFrame(animate);
                
                // Rotación suave del fondo
                particles.rotation.x += 0.0001;
                particles.rotation.y += 0.0001;

                // Animación de los colores de las partículas
                const time = performance.now() * 0.0001;
                const colorAttribute = particlesGeometry.attributes.color;
                
                // Iteramos sobre las partículas para cambiar su color
                for (let i = 0; i < particlesCount; i++) {
                    const r = Math.sin(time + i * 0.1) * 0.5 + 0.5;
                    const g = Math.cos(time + i * 0.1) * 0.5 + 0.5;
                    const b = Math.sin(time + i * 0.1 + Math.PI) * 0.5 + 0.5;
                    
                    colorAttribute.setXYZ(i, r, g, b);
                }

                colorAttribute.needsUpdate = true; // Notificamos a Three.js que los colores han cambiado

                renderer.render(scene, camera);
            }
            
            animate();

            // Lógica para el redimensionamiento de la ventana
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });

            // Lógica para que el mouse interactúe con las partículas
            document.addEventListener('mousemove', (e) => {
                particles.rotation.y = (e.clientX / window.innerWidth) * 2 - 1;
                particles.rotation.x = (e.clientY / window.innerHeight) * 2 - 1;
            });
        }

        // Lógica para las animaciones al hacer scroll
        function initializeScrollAnimations() {
            const sections = document.querySelectorAll('.section-container');
            const observerOptions = {
                root: null,
                rootMargin: '0px',
                threshold: 0.1
            };

            const observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.classList.add('is-visible');
                        observer.unobserve(entry.target);
                    }
                });
            }, observerOptions);

            sections.forEach(section => {
                observer.observe(section);
            });
        }
        
        // Lógica para el reproductor de audio personalizado
        function initializeAudioPlayer() {
            const audioPlayer = document.getElementById('audio-player');
            const playPauseButton = document.getElementById('play-pause-button');
            const playIcon = document.getElementById('play-icon');
            const pauseIcon = document.getElementById('pause-icon');
            const progressBar = document.getElementById('progress-bar');
            const currentTimeSpan = document.getElementById('current-time');
            const durationSpan = document.getElementById('duration');
            const progressBarContainer = document.getElementById('progress-bar-container');

            function formatTime(seconds) {
                const minutes = Math.floor(seconds / 60);
                const secs = Math.floor(seconds % 60);
                return `${minutes}:${secs < 10 ? '0' : ''}${secs}`;
            }

            playPauseButton.addEventListener('click', () => {
                if (audioPlayer.paused) {
                    audioPlayer.play();
                    playIcon.classList.add('hidden');
                    pauseIcon.classList.remove('hidden');
                } else {
                    audioPlayer.pause();
                    playIcon.classList.remove('hidden');
                    pauseIcon.classList.add('hidden');
                }
            });

            audioPlayer.addEventListener('timeupdate', () => {
                if (!isNaN(audioPlayer.duration)) {
                    const progress = (audioPlayer.currentTime / audioPlayer.duration) * 100;
                    progressBar.style.width = `${progress}%`;
                    currentTimeSpan.textContent = formatTime(audioPlayer.currentTime);
                }
            });

            audioPlayer.addEventListener('loadedmetadata', () => {
                if (!isNaN(audioPlayer.duration)) {
                    durationSpan.textContent = formatTime(audioPlayer.duration);
                }
            });
            
            // Permite al usuario hacer clic en la barra de progreso para ir a un punto de la canción
            progressBarContainer.addEventListener('click', (e) => {
                const width = progressBarContainer.clientWidth;
                const clickX = e.offsetX;
                const duration = audioPlayer.duration;
                if (!isNaN(duration)) {
                    audioPlayer.currentTime = (clickX / width) * duration;
                }
            });
        }
        
        // Lógica para la animación de la carta
        function initializeCardAnimation() {
            const envelopeContainer = document.getElementById('envelope-container');
            const envelope = document.getElementById('envelope');

            envelopeContainer.addEventListener('click', () => {
                envelope.classList.toggle('open');
            });
        }
        
        window.addEventListener('load', () => {
            initializeThreeJs();
            initializeScrollAnimations();
            initializeAudioPlayer();
            initializeCardAnimation();
        });

    </script>
</body>
</html>


